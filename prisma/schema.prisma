generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id String @id @default(uuid()) @db.Uuid
  name String
  email String @unique
  emailVerified Boolean @default(false)
  password String
  image String?

  defaultAddressId String? @db.Uuid
  defaultAddress Address? @relation("UserDefaultAddress", fields: [defaultAddressId], references: [id], onDelete: SetNull)

  addresses     Address[]
  invoices      Invoice[]

  accounts      Account[]
  sessions      Session[]

  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  @@map("users")
}

model Account {
  id                String   @id @default(uuid())
  type              String
  provider          String
  providerAccountId String

  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  userId            String    @db.Uuid
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(uuid())
  sessionToken String   @unique
  expires      DateTime

  userId       String   @db.Uuid
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model Address {
  id String @id @default(uuid()) @db.Uuid

  name String
  email String
  street String
  city String
  postalCode String
  country String

  userId String @db.Uuid
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  usersWithThisAsDefault User[] @relation("UserDefaultAddress")

  @@map("addresses")
}

model Invoice {
  id String @id @default(uuid()) @db.Uuid
  projectDescription String

  fromName String
  fromEmail String
  fromStreet String
  fromCity String
  fromPostCode String
  fromCountry String

  toName String
  toEmail String
  toStreet String
  toCity String
  toPostCode String
  toCountry String
  issueDate DateTime
  paymentDue DateTime
  paymentTerms String
  totalPayment Decimal @db.Decimal(10, 2)
  status Status @default(Pending)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId String @db.Uuid
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  items Item[]

  @@index([id, userId])
  @@map("invoices")
}

model Item {
  id String @id @default(uuid()) @db.Uuid
  name String
  quantity Int
  price Decimal @db.Decimal(10, 2)

  invoiceId String @db.Uuid
  invoice Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@map("items")
}

enum Status {
  Draft
  Pending
  Paid
}



